## Имя: Дорджиев Виктор
## Группа: ЭФМО-02-25
# Проект pz8-mongo

Задачи проекта
1)	Понять базовые принципы документной БД MongoDB (документ, коллекция, BSON, _id:ObjectID).
2)	Научиться подключаться к MongoDB из Go с использованием официального драйвера.
3)	Создать коллекцию, индексы и реализовать CRUD для одной сущности (например, notes).
4)	Отработать фильтрацию, пагинацию, обновления (в т.ч. частичные), удаление и обработку ошибок.


---

## Установка и запуск

(Необходимы предустановленные Go версии 1.25 и выше и Git)

Клонировать репозиторий:

```
git clone https://github.com/Unpatches/pz8-mongo
cd pz8-mongo
```

Команда запуска сервера:

```
go run ./cmd/server
```


------

## Структура проекта

```plaintext
pz8-mongo/                     
├── cmd/                  
│   └── server/             
│       └── main.go       
├── internal/              
│   └── db/               
│   │   └── mongo.go
│   └── notes/               
│       └── handler.go
│       └── model.go
│       └── repo.go          
├── go.mod                
└── go.sum       
```

## Отчёт о проделанной работе
### Создание заметки POST

<img width="480" height="501" alt="image" src="https://github.com/user-attachments/assets/5ad99c4d-032a-446c-adb8-acd653ce42eb" />

### Получить все заметки GET

<img width="757" height="686" alt="image" src="https://github.com/user-attachments/assets/223313b8-5bab-4c69-a500-849b0e6fc29c" />

### Получить все заметки по id GET

<img width="739" height="319" alt="image" src="https://github.com/user-attachments/assets/0cd07951-6af8-4665-8cbc-704cea1275e9" />

### Обновить заметку PATCH

<img width="494" height="467" alt="image" src="https://github.com/user-attachments/assets/4cf9482d-2b85-400a-95bd-618442ec5cc1" />

### Удалить заметку DELETE

<img width="498" height="375" alt="image" src="https://github.com/user-attachments/assets/aedd1bc1-be95-4465-976d-a25dafd93fde" />



# Контрольные вопросы
1) Данные хранятся в коллекциях документов, Каждый документ — это JSON-подобный объект (формат BSON), Документы могут иметь разные поля и вложенные структуры.
Удобнее т. к.
- Динамическая и изменяющаяся структура (например, заметки, профили пользователей, каталоги товаров),
- Хранение вложенных объектов (адреса, массивы тегов, списки
файлов).
− Высокая скорость вставки и выборки документов.
− Масштабирование по принципу sharding (распределение
коллекции по нескольким узлам).
2) ObjectID специальный тип _id, автоматически создаётся при вставке. Содержит время создания, случайное значение и счётчик —
гарантирует уникальность. Запросом GET по id.
3) Create, Read, Update, Delete
1. set — устанавливает значение определённого поля. Если поле не существует, оно создаётся.
2. unset — удаляет определённое поле.
3. inc — увеличивает значение числового поля.
4. push — добавляет элемент в массив.
5. pull — удаляет элементы из массива.
4) Типы индексов:
1. Обычный (по одному полю),
2. Составной (по нескольким полям),
3. Уникальный (не допускает дубликатов),
4. TTL (документы удаляются автоматически после заданного
времени).
Нужно использовать метод db.notes.createIndex()
Можно вставить только одно значение с уникальным индексом. Повторное использование индекса приведет к ошибке
5) Это позволяет: 
1. Завершать длинные операции — например, запросы, которые занимают слишком много времени.
2. Отменять выполнение операции, которая больше не нужна — например, если клиент закрыл соединение.
Функция создаёт контекст с автоматической отменой по тайм-ауту. Если контекст истёк, возвращается ошибка, например, context.DeadlineExceeded. Также соединение с базой данных возвращается в пул соединений для повторного использования, что освобождает ресурсы



